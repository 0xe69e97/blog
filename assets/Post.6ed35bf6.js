import{I as E,$ as H,h as N,H as W,i as q,q as D,B as v,m as R,n as V,p as z,S as j,o as l,g as c,w as m,e as L,b as O,l as Y,v as A,j as t,x as $,y as S,s as I,T as M,Y as U,V as G}from"./app.482c2f46.js";import{a as J,_ as K}from"./Page.948b2a0e.js";import{_ as Q}from"./Common.80d27249.js";import{_ as X}from"./Pager.c4a0f5b8.js";const _=({headers:x,activeLink:n})=>{const r=E();return H("ul",{class:{catalog:!0}},x.map(o=>H("li",{class:{active:n===o.slug,[`level-${o.level}`]:!0,[`toc-link-${o.slug}`]:!0},key:o.title,onClick:()=>{r.currentRoute.value.hash!==`#${o.slug}`&&r.push(`#${o.slug}`)}},o.title)))};_.displayName="Catalog";_.props={headers:{type:Object,required:!0},activeLink:{type:String,default:""}};const se=N({setup(x){const n=U();W();const r=q(),o=E(),k=G(),b=k.resolve,F=k.pending,i=D(),P=v(()=>i.value?n.value.headers:[]),T=a=>a.children.length>0?[a].concat(...a.children.map(T)):a,u=v(()=>[].concat(...P.value.map(T))),e=R({headerHeight:0,screenWidth:0,catalogTop:0,activeLink:"",isFixed:!1}),p=40,w=80,d=()=>{for(let s=u.value.length-1;s>=0;s--){const B=u.value[s].slug,C=document.querySelector(`#${B}`);if((C?C.getBoundingClientRect().top:0)<=100){e.activeLink=B;break}}window.pageYOffset>e.headerHeight+p-w?(e.isFixed=!0,e.catalogTop=w):(e.isFixed=!1,e.catalogTop=e.headerHeight+p),e.screenWidth<=719&&(e.catalogTop=-15)},g=()=>{const a=document.querySelector(".post-header");e.headerHeight=a?a.offsetHeight:0,e.screenWidth=document.body.clientWidth,e.screenWidth<=719?e.catalogTop=-15:e.catalogTop=e.headerHeight+p};let y;V(()=>{window.addEventListener("scroll",d),g(),window.onresize=()=>(()=>{g(),d()})(),y=o.afterEach(()=>{g()})}),z(()=>{window.removeEventListener("scroll",d),y()});const{post:f}=j(),h=v(()=>{if(!f.value)return{};const a=f.value.next;a&&(a.text=r.value.postNext);const s=f.value.prev;return s&&(s.text=r.value.postPrev),{next:a,prev:s}});return(a,s)=>(l(),c(Q,null,{page:m(()=>[L(M,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:t(b),onBeforeLeave:t(F)},{default:m(()=>[O("div",{class:S(["post-wrapper",{"show-catalog":t(i)}])},[Y(L(J,{class:"post-header"},null,512),[[A,t(n).title]]),(l(),c(K,{key:t(n).path,class:"post-content"},{bottom:m(()=>[t(h).next||t(h).prev?(l(),c(X,{key:0,data:t(h)},null,8,["data"])):$("",!0)]),_:1})),t(i)?(l(),c(t(_),{key:0,headers:t(u),"active-link":t(e).activeLink,class:S({fixed:t(e).isFixed}),style:I({top:`${t(e).catalogTop}px`})},null,8,["headers","active-link","class","style"])):$("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});export{se as default};
